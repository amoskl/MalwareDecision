import os

from configuration import NGRAM_SIZE, MALWARE_FILES_FOLDER, BENIGN_FILES_FOLDER, OUT_FOLDER, OUT_FILE_NAME, DECISION_TREE_OUTPUT

from ngram.ngram import NgramFromFoldersBuilder
from ngram_classificaiton.classification_methodology import FileReader
from decision_tree.decisiontree import DecisionTree


def main():
    import time
    start_time = time.time()

    ngram_builder = NgramFromFoldersBuilder(NGRAM_SIZE, MALWARE_FILES_FOLDER, BENIGN_FILES_FOLDER, OUT_FOLDER)
    ngram_builder.build()

    file_reader = FileReader(os.path.join(OUT_FOLDER, OUT_FILE_NAME))
    file_reader.read_ngrams()
    ret = file_reader.get_most_informative_ngrams()

    print ret

    tree = DecisionTree(ret)
    tree.drawTree(DECISION_TREE_OUTPUT)

    end_time = time.time()

    print "it took {time} seconds".format(time=end_time-start_time)


if __name__ == "__main__":
    main()